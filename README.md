# Library Management System API

This project is a Library Management System API built using Django, Django REST Framework (DRF), and Celery. The API enables managing authors, books, borrowing records, and generating reports of library activity.

---

## **Features**

### **1. Authors Management**
- Create, retrieve, update, and delete authors.

### **2. Books Management**
- Add, retrieve, update, and delete books.
- Track the number of available copies for each book.

### **3. Borrow Records Management**
- Create borrowing records.
- Mark books as returned and update availability.

### **4. Report Generation**
- Generate a report on library activity, including:
  - Total number of authors.
  - Total number of books.
  - Total books currently borrowed.
- Save the report as a JSON file in the `reports/` directory.
- Retrieve the latest report.

### **5. Background Task**
- Report generation runs as a background task using Celery.

---

## **Installation and Setup**

### **Prerequisites**
- Python 3.8+
- Django 4.x
- Redis (for Celery message broker)

### **Steps to Set Up**

1. **Clone the Repository**:
   ```bash
   git clone https://github.com/nakulsejwar/library-management-api/
   cd library_management
   ```

2. **Create a Virtual Environment**:
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```

3. **Install Dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Apply Migrations**:
   ```bash
   python manage.py migrate
   ```

5. **Run the Development Server**:
   ```bash
   python manage.py runserver
   ```

6. **Start Redis Server**:
   ```bash
   redis-server
   ```

7. **Start the Celery Worker**:
   ```bash
   celery -A library_management_system worker --loglevel=info
   ```

---

## **API Endpoints**

### **Authors**
- `GET /authors/` - List all authors
- `POST /authors/` - Create a new author
- `GET /authors/<id>/` - Retrieve a specific author
- `PUT /authors/<id>/` - Update a specific author
- `DELETE /authors/<id>/` - Delete a specific author

### **Books**
- `GET /books/` - List all books
- `POST /books/` - Add a new book
- `GET /books/<id>/` - Retrieve a specific book
- `PUT /books/<id>/` - Update a specific book
- `DELETE /books/<id>/` - Delete a specific book

### **Borrow Records**
- `POST /borrow/` - Create a new borrow record
- `PUT /borrow/<id>/return/` - Mark a book as returned

### **Reports**
- `POST /reports/` - Generate a new report
- `GET /reports/` - Retrieve the latest report

---

## **Testing**

### **Run the Development Server**
Ensure all services (Django server, Redis, and Celery) are running:
```bash
python manage.py runserver
redis-server
celery -A library_management_system worker --loglevel=info
```

### **Test Endpoints**
Use Postman or curl to test the endpoints. Example:
- **Create an Author**:
  ```bash
  curl -X POST http://127.0.0.1:8000/authors/ \
       -H "Content-Type: application/json" \
       -d '{"name": "Author Name", "bio": "Author Bio"}'
  ```
- **Generate a Report**:
  ```bash
  curl -X POST http://127.0.0.1:8000/reports/
  ```

---

## **Report Generation Details**

- The report is generated by the `generate_report` Celery task.
- Reports are stored in the `reports/` directory.
- File naming convention: `report_YYYYMMDDHHMMSS.json`.
- Example report content:
  ```json
  {
      "total_authors": 5,
      "total_books": 12,
      "total_borrowed_books": 7,
      "generated_at": "2024-12-17 12:00:00"
  }
  ```

---

## **Troubleshooting**

1. **Celery Task Not Running**:
   - Ensure Redis is running.
   - Verify the Celery worker is active.

2. **File Permission Issues**:
   - Ensure the `reports/` directory exists and is writable.
     ```bash
     mkdir -p reports
     chmod 777 reports
     ```

3. **Check Logs**:
   - View Celery logs for errors:
     ```bash
     celery -A library_management_system worker --loglevel=debug
     ```
   - Check Django server logs.

---

## **Future Enhancements**
- User authentication for secure access to the API.
- Pagination for large datasets.
- Email notifications for overdue books.
- Advanced report generation.

---

